/* src/styles/buttons.css */

/* --- Base Button --- */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-2);
  /* Add gap for icon + text layouts */
  font-weight: 600;
  cursor: pointer;
  transition: background-color 0.2s, box-shadow 0.2s, border-color 0.2s;
  box-sizing: border-box;
  line-height: 1;
  border: 1px solid transparent;
  font-family: var(--font-family-sans);
  font-size: var(--font-size-sm);
  white-space: nowrap;
}

.btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
  box-shadow: none;
}

.btn .material-symbols-rounded {
  transition: color 0.2s;
}

/* --- Loading State --- */
.btn[data-loading="true"] {
  pointer-events: none;
}

/* ======================================================================== */
/*                              SIZE VARIANTS                               */
/* ======================================================================== */

/* --- Medium (m) - Desktop Standard --- */
.btn[data-size="m"] {
  /* Desktop Medium */
  height: var(--control-height-md);
  padding: 0 var(--spacing-3);
  /* 12px */
  border-radius: var(--radius-md);
  gap: var(--spacing-1);
  /* 4px */
}

.btn[data-size="m"][data-icon-only="true"] {
  width: var(--control-height-md);
  padding: 0;
  border-radius: var(--radius-md);
  gap: 0;
}

.btn[data-size="m"] .material-symbols-rounded {
  font-size: var(--icon-size-md);
  font-variation-settings: 'opsz' 20;
}

/* --- Large (lg) --- */
.btn[data-size="lg"] {
  height: var(--control-height-lg);
  padding: var(--spacing-3) var(--spacing-5);
  border-radius: var(--spacing-3);
  gap: var(--spacing-2);
}

.btn[data-size="lg"][data-icon-only="true"] {
  width: var(--control-height-lg);
  padding: 0;
  border-radius: var(--radius-md);
  gap: 0;
}

.btn[data-size="lg"] .material-symbols-rounded {
  font-size: var(--icon-size-lg);
}

/* --- Small (s) --- */
.btn[data-size="s"] {
  height: var(--control-height-sm);
  padding: 0 var(--spacing-2p5);
  /* 10px */
  border-radius: var(--radius-md);
  gap: var(--spacing-1);
  /* 4px */
}

.btn[data-size="s"][data-icon-only="true"] {
  width: var(--control-height-sm);
  padding: 0;
  border-radius: var(--radius-md);
  gap: 0;
}

.btn[data-size="s"] .material-symbols-rounded {
  font-size: var(--icon-size-md);
  font-variation-settings: 'opsz' 20;
}

/* --- Extra Small (xs) --- */
.btn[data-size="xs"] {
  height: var(--control-height-xs);
  padding: 0 var(--spacing-2);
  border-radius: var(--radius-sm);
  font-size: var(--font-size-sm);
  gap: var(--spacing-1);
}

.btn[data-size="xs"][data-icon-only="true"] {
  width: var(--control-height-xs);
  padding: 0;
  border-radius: var(--radius-sm);
  gap: 0;
}

.btn[data-size="xs"] .material-symbols-rounded {
  font-size: var(--icon-size-sm);
  font-variation-settings:
    'FILL' 0,
    'wght' 400,
    'GRAD' 0,
    'opsz' 16;
}

/* ======================================================================== */
/*                             STYLE VARIANTS                               */
/* ======================================================================== */

/* --- Primary Button --- */
.btn[data-variant="primary"] {
  background-color: var(--control-bg-theme);
  color: var(--control-fg-on-solid);
  border-color: var(--control-border-primary);
  /* No shadow at rest per latest feedback */
  box-shadow: none;
}

@media (hover: hover) {
  .btn[data-variant="primary"]:hover:not(:disabled) {
    background-color: var(--control-bg-theme-hover);
    border-color: var(--control-border-primary-hover);
    /* 1px border + 2px shadow = 3px visual bottom lip */
    box-shadow: inset 0 -2px 0 0 var(--control-border-primary-pressed);
  }
}

.btn[data-variant="primary"]:active:not(:disabled),
.btn[data-variant="primary"][data-state="open"] {
  background-color: var(--control-bg-theme-pressed);
  border-color: var(--control-border-primary-pressed);
  /* Refined Pressed State: "Darker Pop" (3px visual bottom) using 1-step darker theme-950 shadow */
  box-shadow: inset 0 -2px 0 0 var(--primitives-theme-950) !important;
}

/* --- Secondary Button --- */
.btn[data-variant="secondary"] {
  background-color: var(--control-bg-secondary);
  color: var(--surface-fg-primary);
  border: 1px solid var(--control-border-secondary);
}

@media (hover: hover) {
  .btn[data-variant="secondary"]:hover:not(:disabled) {
    /* 1px top/sides, 3px bottom visual border (1px border + 2px shadow) */
    box-shadow: inset 0 -2px 0 0 var(--control-border-secondary-hover);
    background-color: var(--control-bg-secondary-hover);
    border-color: var(--control-border-secondary-hover);
  }
}

.btn[data-variant="secondary"]:active:not(:disabled),
.btn[data-variant="secondary"][data-state="open"] {
  background-color: var(--control-bg-secondary-pressed);
  border-color: var(--control-border-secondary-pressed);
  /* Refined Pressed State: "Darker Pop" logic (3px visual bottom) per feedback */
  box-shadow: inset 0 -2px 0 0 var(--control-border-secondary-pressed) !important;
}

/* --- Secondary Button Active (Consolidated below) --- */

/* --- Tertiary Button --- */
.btn[data-variant="tertiary"] {
  background: none;
  color: var(--control-fg-tertiary);
  border-color: transparent;
}

@media (hover: hover) {
  .btn[data-variant="tertiary"]:hover:not(:disabled) {
    background-color: var(--control-bg-tertiary-hover);
    color: var(--control-fg-tertiary-hover);
    border-color: var(--control-border-tertiary-hover);
    /* 1px top/sides, 2px bottom visual border (1px border + 1px shadow) */
    box-shadow: inset 0 -1px 0 0 var(--control-border-tertiary-hover);
  }
}

.btn[data-variant="tertiary"]:active:not(:disabled),
.btn[data-variant="tertiary"][data-state="open"] {
  background-color: var(--control-bg-tertiary-pressed);
  color: var(--control-fg-tertiary-hover);
  border-color: var(--control-border-tertiary-pressed);
  /* Refined Pressed State: "Darker Pop" (2px visual bottom) */
  box-shadow: inset 0 -1px 0 0 var(--control-border-tertiary-pressed) !important;
}

/* --- Quaternary Button --- */
.btn[data-variant="quaternary"] {
  background: none;
  color: var(--control-fg-quaternary);
}

@media (hover: hover) {
  .btn[data-variant="quaternary"]:hover:not(:disabled) {
    background-color: var(--control-bg-quaternary-hover);
    color: var(--control-fg-quaternary-hover);
    border-color: var(--control-border-quaternary-hover);
  }
}

.btn[data-variant="quaternary"]:active:not(:disabled) {
  background-color: var(--control-bg-quaternary-pressed);
  color: var(--control-fg-quaternary-hover);
  border-color: var(--control-border-quaternary-pressed);
}

/* --- On Solid Button --- */
.btn[data-variant="on-solid"] {
  background: none;
  color: var(--control-fg-on-solid);
  border: 1px solid transparent;
  /* Match typical button border width */
  box-shadow: none;
}

@media (hover: hover) {
  .btn[data-variant="on-solid"]:hover:not(:disabled) {
    background-color: var(--control-bg-on-solid-hover);
    border-color: var(--control-border-tertiary-hover);
    /* Thicker 2px bottom lip ONLY on hover per latest feedback */
    box-shadow: inset 0 -2px 0 0 var(--control-border-tertiary-hover);
  }
}

.btn[data-variant="on-solid"]:active:not(:disabled),
.btn[data-variant="on-solid"][data-state="open"] {
  background-color: var(--control-bg-on-solid-pressed);
  border-color: var(--control-border-tertiary-pressed);
  /* Refined Pressed State: "Darker Pop" (3px visual bottom) */
  box-shadow: inset 0 -2px 0 0 var(--control-border-tertiary-pressed) !important;
}

/* --- Destructive Button --- */
.btn[data-variant="destructive"] {
  background-color: var(--control-bg-destructive);
  color: var(--control-fg-destructive);
  border-color: var(--control-border-destructive);
  /* Flat at rest per latest design unification */
  box-shadow: none;
}

@media (hover: hover) {
  .btn[data-variant="destructive"]:hover:not(:disabled) {
    background-color: var(--control-bg-destructive-hover);
    border-color: var(--control-border-destructive);
    /* 1px border + 2px shadow = 3px visual bottom */
    box-shadow: inset 0 -2px 0 0 var(--control-border-destructive-pressed);
  }
}

.btn[data-variant="destructive"]:active:not(:disabled) {
  background-color: var(--control-bg-destructive-pressed);
  border-color: var(--control-border-destructive-pressed);
  /* Refined Pressed State: "Darker Pop" logic (3px visual bottom) */
  box-shadow: inset 0 -2px 0 0 var(--control-border-destructive-pressed) !important;
}

/* --- Alert Button (Light Red) --- */
.btn[data-variant="alert"] {
  background-color: var(--control-bg-alert);
  color: var(--control-fg-alert);
  border-color: var(--control-border-alert);
  /* Flat at rest */
  box-shadow: none;
}

@media (hover: hover) {
  .btn[data-variant="alert"]:hover:not(:disabled) {
    background-color: var(--control-bg-alert-hover);
    color: var(--control-fg-alert-hover);
    border-color: var(--control-border-alert-hover);
    /* 1px border + 2px shadow = 3px visual bottom */
    box-shadow: inset 0 -2px 0 0 var(--control-border-alert-hover);
  }
}

.btn[data-variant="alert"]:active:not(:disabled) {
  background-color: var(--control-bg-alert-pressed);
  color: var(--control-fg-alert-pressed);
  border-color: var(--control-border-alert-pressed);
  /* Refined Pressed State: "Darker Pop" logic (3px visual bottom) */
  box-shadow: inset 0 -2px 0 0 var(--control-border-alert-pressed) !important;
}

/* --- Warning Button --- */
.btn[data-variant="warning"] {
  background-color: var(--control-bg-warning);
  color: var(--control-fg-warning);
  border-color: var(--control-border-warning);
  /* Flat at rest */
  box-shadow: none;
}

@media (hover: hover) {
  .btn[data-variant="warning"]:hover:not(:disabled) {
    background-color: var(--control-bg-warning-hover);
    color: var(--control-fg-warning-hover);
    border-color: var(--control-border-warning-hover);
    /* 1px border + 2px shadow = 3px visual bottom */
    box-shadow: inset 0 -2px 0 0 var(--control-border-warning-hover);
  }
}

.btn[data-variant="warning"]:active:not(:disabled) {
  background-color: var(--control-bg-warning-pressed);
  color: var(--control-fg-warning-pressed);
  border-color: var(--control-border-warning-pressed);
  /* Refined Pressed State: "Darker Pop" logic (3px visual bottom) */
  box-shadow: inset 0 -2px 0 0 var(--control-border-warning-pressed) !important;
}

/* --- Success Button --- */
.btn[data-variant="success"] {
  background-color: var(--control-bg-success);
  color: var(--control-fg-success);
  border-color: var(--control-border-success);
  /* Flat at rest */
  box-shadow: none;
}

@media (hover: hover) {
  .btn[data-variant="success"]:hover:not(:disabled) {
    background-color: var(--control-bg-success-hover);
    color: var(--control-fg-success-hover);
    border-color: var(--control-border-success-hover);
    /* 1px border + 2px shadow = 3px visual bottom */
    box-shadow: inset 0 -2px 0 0 var(--control-border-success-hover);
  }
}

.btn[data-variant="success"]:active:not(:disabled) {
  background-color: var(--control-bg-success-pressed);
  color: var(--control-fg-success-pressed);
  border-color: var(--control-border-success-pressed);
  /* Refined Pressed State: "Darker Pop" logic (3px visual bottom) */
  box-shadow: inset 0 -2px 0 0 var(--control-border-success-pressed) !important;
}

/* --- Info Button --- */
.btn[data-variant="info"] {
  background-color: var(--control-bg-info);
  color: var(--control-fg-info);
  border-color: var(--control-border-info);
  /* Flat at rest */
  box-shadow: none;
}

@media (hover: hover) {
  .btn[data-variant="info"]:hover:not(:disabled) {
    background-color: var(--control-bg-info-hover);
    color: var(--control-fg-info-hover);
    border-color: var(--control-border-info-hover);
    /* 1px border + 2px shadow = 3px visual bottom */
    box-shadow: inset 0 -2px 0 0 var(--control-border-info-hover);
  }
}

.btn[data-variant="info"]:active:not(:disabled) {
  background-color: var(--control-bg-info-pressed);
  color: var(--control-fg-info-pressed);
  border-color: var(--control-border-info-pressed);
  /* Refined Pressed State: "Darker Pop" logic (3px visual bottom) */
  box-shadow: inset 0 -2px 0 0 var(--control-border-info-pressed) !important;
}

/* ------------------------------------------------------------------------ */
/*                               BUTTONS                                    */
/* ------------------------------------------------------------------------ */
/**
 * ARCHITECTURAL INVARIANTS:
 * 1. Rest State: All solid/bordered variants (Primary, Secondary, Semantic) must be
 *    "flat" (1px border only) at rest to minimize visual noise.
 * 2. Hover State: All solid variants must show a 3px visual bottom border
 *    (1px physical + 2px inset shadow) for skeuomorphic "pop".
 * 3. Pressed State: 
 *    - Primary/Semantic: Recessed look (sharp top inner shadow) for tactile depth.
 *    - Secondary/Filters: "Darker Pop" logic (Matching hover structural depth but
 *      with pressed tokens) per latest design specification.
 * 4. Selected State (data-active="true"): Must maintain distinct priority:
 *    - Rest: 2px visual all sides (1px + 1px inset).
 *    - Hover: 4px visual bottom (1px + 1px + 2px extra emphasis).
 * 5. Tertiary/Ghost: Minimal depth (2px hover) to maintain visual hierarchy.
 */

.btn {
  display: inline-flex;
}

/* ======================================================================== */
/*                              GLOBAL STATES                               */
/* ======================================================================== */

/* ============================================================================
 * SELECTED STATE (data-active="true") - CRITICAL INVARIANTS
 * ============================================================================
 * 
 * VISUAL BORDER MODEL:
 *   - REST:    2px visual ALL sides (1px physical + 1px inset shadow)
 *   - HOVER:   2px sides, 4px bottom (1px + 1px + 2px extra bottom)
 *   - PRESSED: Same geometry as hover but with DARKER (-pressed) tokens
 * 
 * REQUIRED TOKENS (must exist in semantics.css for ALL themes):
 *   - --control-bg-selected, --control-bg-selected-hover, --control-bg-selected-pressed
 *   - --control-border-selected, --control-border-selected-hover, --control-border-selected-pressed
 *   - --control-fg-selected, --control-fg-selected-hover
 * 
 * SPECIFICITY: Uses !important to override variant-level styles (e.g., secondary)
 *              because variant styles also use !important for their pressed states.
 * 
 * If ANY token is missing, the visual model WILL BREAK silently (empty shadows).
 * ============================================================================ */

/* --- Active / Selected State --- */
/* Used for toggles, multi-select triggers, etc. */
.btn[data-active="true"],
.btn.active {
  background-color: var(--control-bg-selected);
  color: var(--control-fg-selected);
  border-color: var(--control-border-selected);
  /* 1px physical + 1px all-around inset = 2px visual border */
  box-shadow: inset 0 0 0 1px var(--control-border-selected);
}

@media (hover: hover) {

  .btn[data-active="true"]:hover:not(:disabled),
  .btn.active:hover:not(:disabled) {
    background-color: var(--control-bg-selected-hover);
    color: var(--control-fg-selected-hover);
    border-color: var(--control-border-selected-hover);
    /* 1px physical + 1px all-around + 2px extra bottom = 2px sides, 4px visual bottom total */
    box-shadow: inset 0 0 0 1px var(--control-border-selected-hover), inset 0 -2px 0 0 var(--control-border-selected-hover);
  }
}

.btn[data-active="true"]:active:not(:disabled),
.btn.active:active:not(:disabled),
.btn[data-active="true"][data-state="open"],
.btn.active[data-state="open"] {
  background-color: var(--control-bg-selected-pressed) !important;
  border-color: var(--control-border-selected-pressed) !important;
  /* Refined Pressed State: "Darker Pop" logic (2px sides, 4px visual bottom) */
  box-shadow: inset 0 0 0 1px var(--control-border-selected-pressed), inset 0 -2px 0 0 var(--control-border-selected-pressed) !important;
  color: var(--control-fg-selected-hover) !important;
}